<?xml version = '1.0' encoding = 'ISO-8859-1' ?>

<project default="main" basedir=".">

  <presetdef name="my.javac">
    <javac includeantruntime="false" />
  </presetdef>

  <property file=".ant.properties"/>
  <property file="${user.home}/.ant.properties"/>
  <property name="build.debug" value="true"/>
  <property name="build.optimize" value="false"/>
  <property name="build.deprecation" value="false"/>

  <path id="javac.classpath">
    <pathelement location="."/>
    <fileset dir="./lib">
      <include name="**/*.jar"/>
    </fileset>

    <fileset dir="/opt/pi4j/lib">
      <include name="**/*.jar" />
    </fileset>
  </path>

  <target name="compile">
    <my.javac srcdir="java"
              debug="${build.debug}"
              optimize="${build.optimize}"
              deprecation="${build.deprecation}"
              classpathref="javac.classpath">
    </my.javac>

    <exec executable="./compile.sh" dir="C" />
  </target>

  <target name="dist" depends="compile">

    <jar destfile="dist/gatekeeper.jar">
         <fileset dir="java" includes="**/*.class" />
    </jar>

  </target>

  <target name="clean">
    <delete>
      <fileset dir="java" includes = "**/*.class"/>
      <fileset dir="dist" includes = "**/*.jar"/>
      <fileset dir="C" includes = "**/*.o"/>
      <!-- dangerous, but .h files only autogenerated by jni -->
      <fileset dir="C" includes = "**/*.h"/>
    </delete>
  </target>

  <target name="main" depends="dist"/>

</project>

